#!/bin/bash
set -e

echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ—Å–±–æ—Ä–∫—É –∫–ª–∏–µ–Ω—Ç–∞"

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /root/escort-project

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞
echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞"
docker-compose stop client
docker-compose rm -f client

# –û—á–∏—â–∞–µ–º –∫—ç—à Docker –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
echo "üßπ –û—á–∏—â–∞–µ–º –∫—ç—à Docker –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞"
docker system prune -f --filter "label=com.docker.compose.project=escort-project" --filter "label=com.docker.compose.service=client"

# –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç
echo "üèóÔ∏è –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –∫–ª–∏–µ–Ω—Ç"
docker-compose build --no-cache client

# –ó–∞–ø—É—Å–∫–∞–µ–º –∫–ª–∏–µ–Ω—Ç
echo "‚úÖ –ó–∞–ø—É—Å–∫–∞–µ–º –∫–ª–∏–µ–Ω—Ç"
docker-compose up -d client

# –î–∞–µ–º –≤—Ä–µ–º—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
echo "‚è≥ –û–∂–∏–¥–∞–µ–º –∑–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞..."
sleep 10

echo "‚úÖ –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
echo "üåê –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: https://eskortvsegorodarfreal.site"
