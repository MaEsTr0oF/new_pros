{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Typography,Paper,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,IconButton,Button,Tooltip,CircularProgress,Box,Dialog,DialogTitle,DialogContent,DialogContentText,DialogActions}from'@mui/material';import EditIcon from'@mui/icons-material/Edit';import DeleteIcon from'@mui/icons-material/Delete';import CheckCircleIcon from'@mui/icons-material/CheckCircle';import CancelIcon from'@mui/icons-material/Cancel';import AdminLayout from'../../components/admin/AdminLayout';import{apiClient}from'../../api-wrapper';import ProfileOrderButtons from'../../components/admin/ProfileOrderButtons';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfilesPage=()=>{const[profiles,setProfiles]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[deleteDialogOpen,setDeleteDialogOpen]=useState(false);const[profileToDelete,setProfileToDelete]=useState(null);useEffect(()=>{fetchProfiles();},[]);const fetchProfiles=async()=>{try{setLoading(true);const response=await apiClient.get('/admin/profiles');setProfiles(response.data);setError('');}catch(err){console.error('Ошибка при загрузке профилей:',err);setError('Не удалось загрузить данные. Пожалуйста, попробуйте позже.');}finally{setLoading(false);}};const handleEdit=id=>{window.location.href=`/admin/profiles/edit/${id}`;};const handleOpenDeleteDialog=id=>{setProfileToDelete(id);setDeleteDialogOpen(true);};const handleCloseDeleteDialog=()=>{setDeleteDialogOpen(false);setProfileToDelete(null);};const handleDelete=async()=>{if(profileToDelete){try{await apiClient.delete(`/admin/profiles/${profileToDelete}`);setDeleteDialogOpen(false);setProfileToDelete(null);fetchProfiles();}catch(err){console.error('Ошибка при удалении профиля:',err);alert('Не удалось удалить профиль');}}};return/*#__PURE__*/_jsx(AdminLayout,{children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,children:\"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0430\\u043D\\u043A\\u0435\\u0442\\u0430\\u043C\\u0438\"}),/*#__PURE__*/_jsx(Box,{sx:{mb:2,display:'flex',justifyContent:'flex-end'},children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:()=>window.location.href='/admin/profiles/create',children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u0443\\u044E \\u0430\\u043D\\u043A\\u0435\\u0442\\u0443\"})}),loading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:3},children:/*#__PURE__*/_jsx(CircularProgress,{})}):error?/*#__PURE__*/_jsx(Typography,{color:\"error\",children:error}):/*#__PURE__*/_jsx(Paper,{children:/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0418\\u043C\\u044F\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0413\\u043E\\u0440\\u043E\\u0434\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0426\\u0435\\u043D\\u0430\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:profiles.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:7,align:\"center\",children:\"\\u0410\\u043D\\u043A\\u0435\\u0442\\u044B \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B\"})}):profiles.map(profile=>{var _profile$city;return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:profile.id}),/*#__PURE__*/_jsx(TableCell,{children:profile.name}),/*#__PURE__*/_jsx(TableCell,{children:profile.age}),/*#__PURE__*/_jsx(TableCell,{children:((_profile$city=profile.city)===null||_profile$city===void 0?void 0:_profile$city.name)||'Не указан'}),/*#__PURE__*/_jsxs(TableCell,{children:[profile.price1Hour,\" \\u20BD/\\u0447\\u0430\\u0441\"]}),/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(Tooltip,{title:profile.isActive?'Активен':'Неактивен',children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",color:profile.isActive?'success':'error',children:profile.isActive?/*#__PURE__*/_jsx(CheckCircleIcon,{}):/*#__PURE__*/_jsx(CancelIcon,{})})}),profile&&/*#__PURE__*/_jsx(ProfileOrderButtons,{profileId:profile.id})]}),/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleEdit(profile.id),size:\"small\",color:\"primary\",children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleOpenDeleteDialog(profile.id),size:\"small\",color:\"error\",children:/*#__PURE__*/_jsx(DeleteIcon,{})})]})]},profile.id);})})]})})}),/*#__PURE__*/_jsxs(Dialog,{open:deleteDialogOpen,onClose:handleCloseDeleteDialog,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"\\u0423\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0430\\u043D\\u043A\\u0435\\u0442\\u044B\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(DialogContentText,{children:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u044D\\u0442\\u0443 \\u0430\\u043D\\u043A\\u0435\\u0442\\u0443? \\u042D\\u0442\\u043E \\u0434\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0435 \\u043D\\u0435\\u043B\\u044C\\u0437\\u044F \\u0431\\u0443\\u0434\\u0435\\u0442 \\u043E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C.\"})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleCloseDeleteDialog,color:\"primary\",children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"}),/*#__PURE__*/_jsx(Button,{onClick:handleDelete,color:\"error\",autoFocus:true,children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]})]})});};export default ProfilesPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}