{"ast":null,"code":"import ProfileOrderButtons from\"../../components/admin/ProfileOrderButtons\";import React,{useState,useEffect}from'react';import{Container,Paper,Typography,Box,Button,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,IconButton,Chip,Alert,CircularProgress}from'@mui/material';import{Edit as EditIcon,Delete as DeleteIcon,Add as AddIcon}from'@mui/icons-material';import{useNavigate}from'react-router-dom';import axios from'axios';import{API_URL}from'../../config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminDashboard=()=>{const navigate=useNavigate();const[profiles,setProfiles]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const token=localStorage.getItem('adminToken');useEffect(()=>{if(!token){navigate('/admin/login');return;}const fetchProfiles=async()=>{try{setLoading(true);const response=await axios.get(`${API_URL}/admin/profiles`,{headers:{Authorization:`Bearer ${token}`}});setProfiles(response.data);}catch(error){console.error('Error fetching profiles:',error);setError('Ошибка при загрузке анкет');}finally{setLoading(false);}};fetchProfiles();},[token,navigate]);const handleDelete=async id=>{if(!window.confirm('Вы уверены, что хотите удалить эту анкету?')){return;}try{await axios.delete(`${API_URL}/admin/profiles/${id}`,{headers:{Authorization:`Bearer ${token}`}});setProfiles(profiles.filter(profile=>profile.id!==id));}catch(error){console.error('Error deleting profile:',error);setError('Ошибка при удалении анкеты');}};const handleLogout=()=>{localStorage.removeItem('adminToken');navigate('/admin/login');};if(loading){return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh'},children:/*#__PURE__*/_jsx(CircularProgress,{})});}return/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{py:4},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",children:\"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0430\\u043D\\u043A\\u0435\\u0442\\u0430\\u043C\\u0438\"}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(AddIcon,{}),onClick:()=>navigate('/admin/profiles/new'),sx:{mr:2},children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0430\\u043D\\u043A\\u0435\\u0442\\u0443\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:handleLogout,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]})]}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0418\\u043C\\u044F\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0413\\u043E\\u0440\\u043E\\u0434\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:profiles.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:6,align:\"center\",children:\"\\u041D\\u0435\\u0442 \\u0430\\u043D\\u043A\\u0435\\u0442 \\u0434\\u043B\\u044F \\u043E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F\"})}):profiles.map(profile=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:profile.id}),/*#__PURE__*/_jsx(TableCell,{children:profile.name}),/*#__PURE__*/_jsx(TableCell,{children:profile.cityId}),/*#__PURE__*/_jsx(TableCell,{children:profile.phone}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:profile.isActive?'Активна':'Неактивна',color:profile.isActive?'success':'default',size:\"small\"})}),/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(IconButton,{onClick:()=>navigate(`/admin/profiles/${profile.id}/edit`),size:\"small\",children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(ProfileOrderButtons,{profileId:profile.id}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleDelete(profile.id),size:\"small\",color:\"error\",children:/*#__PURE__*/_jsx(DeleteIcon,{})}),/*#__PURE__*/_jsx(ProfileOrderButtons,{profileId:profile.id})]})]},profile.id))})]})})]});};export default AdminDashboard;","map":{"version":3,"names":["ProfileOrderButtons","React","useState","useEffect","Container","Paper","Typography","Box","Button","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","IconButton","Chip","Alert","CircularProgress","Edit","EditIcon","Delete","DeleteIcon","Add","AddIcon","useNavigate","axios","API_URL","jsx","_jsx","jsxs","_jsxs","AdminDashboard","navigate","profiles","setProfiles","loading","setLoading","error","setError","token","localStorage","getItem","fetchProfiles","response","get","headers","Authorization","data","console","handleDelete","id","window","confirm","delete","filter","profile","handleLogout","removeItem","sx","display","justifyContent","alignItems","height","children","maxWidth","py","mb","variant","component","startIcon","onClick","mr","severity","length","colSpan","align","map","name","cityId","phone","label","isActive","color","size","profileId"],"sources":["/root/escort-project/client/src/pages/admin/AdminDashboard.tsx"],"sourcesContent":["import ProfileOrderButtons from \"../../components/admin/ProfileOrderButtons\";\nimport React, { useState, useEffect } from 'react';\nimport {\n  Container,\n  Paper,\n  Typography,\n  Box,\n  Button,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  IconButton,\n  Chip,\n  Alert,\n  CircularProgress,\n} from '@mui/material';\nimport {\n  Edit as EditIcon,\n  Delete as DeleteIcon,\n  Add as AddIcon,\n} from '@mui/icons-material';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { API_URL } from '../../config';\nimport { Profile } from '../../types';\n\nconst AdminDashboard: React.FC = () => {\n  const navigate = useNavigate();\n  const [profiles, setProfiles] = useState<Profile[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const token = localStorage.getItem('adminToken');\n\n  useEffect(() => {\n    if (!token) {\n      navigate('/admin/login');\n      return;\n    }\n\n    const fetchProfiles = async () => {\n      try {\n        setLoading(true);\n        const response = await axios.get(`${API_URL}/admin/profiles`, {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        });\n        setProfiles(response.data);\n      } catch (error) {\n        console.error('Error fetching profiles:', error);\n        setError('Ошибка при загрузке анкет');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchProfiles();\n  }, [token, navigate]);\n\n  const handleDelete = async (id: number) => {\n    if (!window.confirm('Вы уверены, что хотите удалить эту анкету?')) {\n      return;\n    }\n\n    try {\n      await axios.delete(`${API_URL}/admin/profiles/${id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      setProfiles(profiles.filter(profile => profile.id !== id));\n    } catch (error) {\n      console.error('Error deleting profile:', error);\n      setError('Ошибка при удалении анкеты');\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('adminToken');\n    navigate('/admin/login');\n  };\n\n  if (loading) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 4 }}>\n        <Typography variant=\"h4\" component=\"h1\">\n          Управление анкетами\n        </Typography>\n        <Box>\n          <Button\n            variant=\"contained\"\n            startIcon={<AddIcon />}\n            onClick={() => navigate('/admin/profiles/new')}\n            sx={{ mr: 2 }}\n          >\n            Добавить анкету\n          </Button>\n          <Button\n            variant=\"outlined\"\n            onClick={handleLogout}\n          >\n            Выйти\n          </Button>\n        </Box>\n      </Box>\n\n      {error && (\n        <Alert severity=\"error\" sx={{ mb: 2 }}>\n          {error}\n        </Alert>\n      )}\n\n      <TableContainer component={Paper}>\n        <Table>\n          <TableHead>\n            <TableRow>\n              <TableCell>ID</TableCell>\n              <TableCell>Имя</TableCell>\n              <TableCell>Город</TableCell>\n              <TableCell>Телефон</TableCell>\n              <TableCell>Статус</TableCell>\n              <TableCell>Действия</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {profiles.length === 0 ? (\n              <TableRow>\n                <TableCell colSpan={6} align=\"center\">\n                  Нет анкет для отображения\n                </TableCell>\n              </TableRow>\n            ) : (\n              profiles.map((profile) => (\n                <TableRow key={profile.id}>\n                  <TableCell>{profile.id}</TableCell>\n                  <TableCell>{profile.name}</TableCell>\n                  <TableCell>{profile.cityId}</TableCell>\n                  <TableCell>{profile.phone}</TableCell>\n                  <TableCell>\n                    <Chip\n                      label={profile.isActive ? 'Активна' : 'Неактивна'}\n                      color={profile.isActive ? 'success' : 'default'}\n                      size=\"small\"\n                    />\n                  </TableCell>\n                  <TableCell>\n                    <IconButton\n                      onClick={() => navigate(`/admin/profiles/${profile.id}/edit`)}\n                      size=\"small\"\n                    >\n                      <EditIcon />\n                    </IconButton>\n              <ProfileOrderButtons profileId={profile.id} />\n                    <IconButton\n                      onClick={() => handleDelete(profile.id)}\n                      size=\"small\"\n                      color=\"error\"\n                    >\n                      <DeleteIcon />\n                    </IconButton>\n              <ProfileOrderButtons profileId={profile.id} />\n                  </TableCell>\n                </TableRow>\n              ))\n            )}\n          </TableBody>\n        </Table>\n      </TableContainer>\n    </Container>\n  );\n};\n\nexport default AdminDashboard; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}