{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Typography,Grid,Card,CardContent,CardActions,IconButton,Button,CircularProgress,Box,Paper,Divider}from'@mui/material';import EditIcon from'@mui/icons-material/Edit';import DeleteIcon from'@mui/icons-material/Delete';import AdminLayout from'../../components/admin/AdminLayout';import{apiClient}from'../../api-wrapper';import ProfileOrderButtons from'../../components/admin/ProfileOrderButtons';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AdminDashboard=()=>{const[profiles,setProfiles]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');useEffect(()=>{fetchProfiles();},[]);const fetchProfiles=async()=>{try{setLoading(true);const response=await apiClient.get('/admin/profiles');setProfiles(response.data);setError('');}catch(err){console.error('Ошибка при загрузке профилей:',err);setError('Не удалось загрузить данные. Пожалуйста, попробуйте позже.');}finally{setLoading(false);}};const handleEdit=id=>{window.location.href=`/admin/profiles/edit/${id}`;};const handleDelete=id=>{if(window.confirm('Вы уверены, что хотите удалить эту анкету?')){apiClient.delete(`/admin/profiles/${id}`).then(()=>{fetchProfiles();}).catch(err=>{console.error('Ошибка при удалении:',err);alert('Не удалось удалить анкету');});}};return/*#__PURE__*/_jsx(AdminLayout,{children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,children:\"\\u041F\\u0430\\u043D\\u0435\\u043B\\u044C \\u0443\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F\"}),/*#__PURE__*/_jsxs(Paper,{sx:{padding:2,mb:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,children:\"\\u041D\\u0435\\u0434\\u0430\\u0432\\u043D\\u0438\\u0435 \\u0430\\u043D\\u043A\\u0435\\u0442\\u044B\"}),/*#__PURE__*/_jsx(Divider,{sx:{mb:2}}),loading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:3},children:/*#__PURE__*/_jsx(CircularProgress,{})}):error?/*#__PURE__*/_jsx(Typography,{color:\"error\",children:error}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:profiles.slice(0,6).map(profile=>{var _profile$city;return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:profile.name}),/*#__PURE__*/_jsxs(Typography,{color:\"textSecondary\",children:[profile.age,\" \\u043B\\u0435\\u0442\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:((_profile$city=profile.city)===null||_profile$city===void 0?void 0:_profile$city.name)||'Город не указан'}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[profile.price1Hour,\" \\u20BD/\\u0447\\u0430\\u0441\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441: \",profile.isActive?'Активен':'Неактивен']})]}),/*#__PURE__*/_jsxs(CardActions,{children:[/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleEdit(profile.id),size:\"small\",color:\"primary\",children:/*#__PURE__*/_jsx(EditIcon,{})}),profile&&/*#__PURE__*/_jsx(ProfileOrderButtons,{profileId:profile.id}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleDelete(profile.id),size:\"small\",color:\"error\",children:/*#__PURE__*/_jsx(DeleteIcon,{})})]})]})},profile.id);})}),profiles.length>6&&/*#__PURE__*/_jsx(Box,{sx:{mt:2,textAlign:'right'},children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:()=>window.location.href='/admin/profiles',children:\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u0432\\u0441\\u0435 \\u0430\\u043D\\u043A\\u0435\\u0442\\u044B\"})}),profiles.length===0&&/*#__PURE__*/_jsx(Typography,{align:\"center\",sx:{py:3},children:\"\\u0410\\u043D\\u043A\\u0435\\u0442\\u044B \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B\"})]})]}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'flex-end',mt:2},children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:()=>window.location.href='/admin/profiles/create',children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u0443\\u044E \\u0430\\u043D\\u043A\\u0435\\u0442\\u0443\"})})]})});};export default AdminDashboard;","map":{"version":3,"names":["React","useState","useEffect","Container","Typography","Grid","Card","CardContent","CardActions","IconButton","Button","CircularProgress","Box","Paper","Divider","EditIcon","DeleteIcon","AdminLayout","apiClient","ProfileOrderButtons","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AdminDashboard","profiles","setProfiles","loading","setLoading","error","setError","fetchProfiles","response","get","data","err","console","handleEdit","id","window","location","href","handleDelete","confirm","delete","then","catch","alert","children","variant","component","gutterBottom","sx","padding","mb","display","justifyContent","p","color","container","spacing","slice","map","profile","_profile$city","item","xs","sm","md","name","age","city","price1Hour","isActive","onClick","size","profileId","length","mt","textAlign","align","py"],"sources":["/root/escort-project/client/src/pages/admin/AdminDashboard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Container, Typography, Grid, Card, CardContent, CardActions, IconButton,\n         Button, CircularProgress, Box, Paper, Divider } from '@mui/material';\nimport EditIcon from '@mui/icons-material/Edit';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport AdminLayout from '../../components/admin/AdminLayout';\nimport { apiClient } from '../../api-wrapper';\nimport ProfileOrderButtons from '../../components/admin/ProfileOrderButtons';\n\nconst AdminDashboard: React.FC = () => {\n  const [profiles, setProfiles] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    fetchProfiles();\n  }, []);\n\n  const fetchProfiles = async () => {\n    try {\n      setLoading(true);\n      const response = await apiClient.get('/admin/profiles');\n      setProfiles(response.data);\n      setError('');\n    } catch (err) {\n      console.error('Ошибка при загрузке профилей:', err);\n      setError('Не удалось загрузить данные. Пожалуйста, попробуйте позже.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEdit = (id: number) => {\n    window.location.href = `/admin/profiles/edit/${id}`;\n  };\n\n  const handleDelete = (id: number) => {\n    if (window.confirm('Вы уверены, что хотите удалить эту анкету?')) {\n      apiClient.delete(`/admin/profiles/${id}`)\n        .then(() => {\n          fetchProfiles();\n        })\n        .catch((err) => {\n          console.error('Ошибка при удалении:', err);\n          alert('Не удалось удалить анкету');\n        });\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <Container>\n        <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n          Панель управления\n        </Typography>\n\n        <Paper sx={{ padding: 2, mb: 4 }}>\n          <Typography variant=\"h5\" gutterBottom>\n            Недавние анкеты\n          </Typography>\n          <Divider sx={{ mb: 2 }} />\n\n          {loading ? (\n            <Box sx={{ display: 'flex', justifyContent: 'center', p: 3 }}>\n              <CircularProgress />\n            </Box>\n          ) : error ? (\n            <Typography color=\"error\">{error}</Typography>\n          ) : (\n            <>\n              <Grid container spacing={3}>\n                {profiles.slice(0, 6).map((profile) => (\n                  <Grid item xs={12} sm={6} md={4} key={profile.id}>\n                    <Card>\n                      <CardContent>\n                        <Typography variant=\"h6\">{profile.name}</Typography>\n                        <Typography color=\"textSecondary\">{profile.age} лет</Typography>\n                        <Typography variant=\"body2\">\n                          {profile.city?.name || 'Город не указан'}\n                        </Typography>\n                        <Typography variant=\"body2\">\n                          {profile.price1Hour} ₽/час\n                        </Typography>\n                        <Typography variant=\"body2\">\n                          Статус: {profile.isActive ? 'Активен' : 'Неактивен'}\n                        </Typography>\n                      </CardContent>\n                      <CardActions>\n                        <IconButton\n                          onClick={() => handleEdit(profile.id)}\n                          size=\"small\"\n                          color=\"primary\"\n                        >\n                          <EditIcon />\n                        </IconButton>\n\n                        {profile && <ProfileOrderButtons profileId={profile.id} />}\n\n                        <IconButton\n                          onClick={() => handleDelete(profile.id)}\n                          size=\"small\"\n                          color=\"error\"\n                        >\n                          <DeleteIcon />\n                        </IconButton>\n                      </CardActions>\n                    </Card>\n                  </Grid>\n                ))}\n              </Grid>\n\n              {profiles.length > 6 && (\n                <Box sx={{ mt: 2, textAlign: 'right' }}>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={() => window.location.href = '/admin/profiles'}\n                  >\n                    Показать все анкеты\n                  </Button>\n                </Box>\n              )}\n\n              {profiles.length === 0 && (\n                <Typography align=\"center\" sx={{ py: 3 }}>\n                  Анкеты не найдены\n                </Typography>\n              )}\n            </>\n          )}\n        </Paper>\n\n        <Box sx={{ display: 'flex', justifyContent: 'flex-end', mt: 2 }}>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={() => window.location.href = '/admin/profiles/create'}\n          >\n            Добавить новую анкету\n          </Button>\n        </Box>\n      </Container>\n    </AdminLayout>\n  );\n};\n\nexport default AdminDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}